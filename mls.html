<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="generator" content=
  "HTML Tidy for HTML5 for Apple macOS version 5.8.0">
  <meta charset="utf-8">
  <title>Messaging Layer Security over ActivityPub</title>
  <script src="https://www.w3.org/Tools/respec/respec-w3c" class=
  "remove" defer></script>
  <script class="remove">
      // All config options at https://respec.org/docs/
      var respecConfig = {
        specStatus: "CG-DRAFT",
        editors: [{ name: "Evan Prodromou", url: "https://socialwebfoundation.org/@evanp" }],
        github: "swicg/activitypub-e2ee",
        shortName: "apmls",
        xref: ["web-platform", "activitystreams-vocabulary", "activitystreams-core", "activitypub"],
        group: "socialcg",
      };
  </script>
  <style>
      table td,
      table td * {
        vertical-align: top;
      }
  </style>
</head>
<body>
  <section id="abstract">
    <h2>Abstract</h2>
    <p>This specification documents the use of Messaging Layer
    Security (MLS) over the ActivityPub API and federation
    protocol. MLS is a protocol for end-to-end encryption of group
    messaging. ActivityPub is a federated social networking
    protocol. This specification describes how to use ActivityPub
    as a transport layer for MLS encrypted conversations.</p>
  </section>
  <section id="sotd"></section>
  <section class="informative" id="introduction">
    <h2>Introduction</h2>
    <p>Messaging Layer Security (MLS) [[rfc9420]] is an end-to-end
    encrypted messaging framework. It is designed to work with
    different lower-level protocols which provide necessary
    services for transporting data around the network.</p>
    <p>[[ActivityPub]] is the W3C social networking standard. It
    defines an API for client to server interactions and a
    federation protocol for server to server communications.
    ActivityPub's native data format is Activity Streams 2.0 (AS2)
    [[activitystreams-core]], an extensible [[JSON-LD]] vocabulary
    for common social network objects and activities.</p>
    <p>This document describes the interfaces between MLS and
    ActivityPub. In particular, it explains how ActivityPub can
    provide the Delivery Service and Authentication Service
    features of MLS, as described in the MLS Architecture
    [[rfc9750]]. It provides an extension to the AS2 Activity
    Vocabulary for supporting these features.</p>
    <p>The data structure of this specification follows a
    three-layer model:</p>
    <ul>
      <li>ActivityPub as an envelope data structure, to ensure data
      routing, persistence, and federation across servers. The JSON
      envelopes are conveyed directly across the ActivityPub
      network.</li>
      <li>MLS as an encryption and signature layer, as well as a
      group management layer. MLS messages carry information such
      as the formation of a group, adding and removing members of a
      group, and changes to the shared encryption keys for the
      group. The MLS message objects are embedded as base64-encoded
      binary objects within the ActivityPub JSON envelopes.</li>
      <li>A limited profile of Activity Streams 2.0 for
      representing messages and conversations (see <a>application
      data</a>). This profile is <b>not</b> compatible with
      ActivityPub -- in particular, because object IDs in this
      profile are not HTTPS URLs. ActivityPub servers do not manage
      these objects, and are in fact unaware of their contents or
      interrelationships -- which is the point of end-to-end
      encryption, after all. These AS2 objects are embedded in the
      <code>application_data</code> fields of MLS PrivateMessage
      objects.
      </li>
    </ul>
    <p>This document is not an implementation manual for MLS over
    ActivityPub. Instead, it attempts to provide a minimal
    interaction layer between the two frameworks. Implementers
    should be familiar with both MLS and ActivityPub.</p>
  </section>
  <section id="delivery-service">
    <h2>Delivery Service</h2>
    <p>The Delivery Service role in MLS has two main
    responsibilities:</p>
    <ul>
      <li>delivery of messages to the group ("Group channel")</li>
      <li>maintaining a key store ("directory")</li>
    </ul>
    <section id="message-delivery">
      <h3>Message delivery</h3>
      <p>ActivityPub provides a robust delivery mechanism for AS2
      objects. To send an object to others on the network, a user
      POSTs a <code>Create</code> activity to their own
      <code>outbox</code> property with the addresses of the
      recipients in the <code>to</code> or <code>cc</code>
      properties. The sending actor's server adds an
      <code>id</code> property to the activity and the object and
      stores the object before forwarding it to the recipients
      across the federation protocol.</p>
      <aside class="example" title=
      "An object as sent from server to server">
        <pre class="json">
            {
              "@context": "https://www.w3.org/ns/activitystreams",
              "type": "Create",
              "id": "https://social.example/user/example1/create/1",
              "actor": "https://social.example/user/example1",
              "to": ["https://other.example/user/example2","https://third.example/user/example3"],
              "object": {
                "type": "Object",
                "summary": "An example object",
                "id": "https://social.example/user/example1/object/1",
                "attributedTo": "https://social.example/user/example1",
              "to": ["https://other.example/user/example2","https://third.example/user/example3"],
              }
            }
          </pre>
      </aside>
      <p>MLS data is structured in a binary format and includes
      detailed encryption and signature fields. For this reason,
      the MLS wire formats are preserved in AS2 objects with
      <code>mediaType</code> set to <code>message/mls</code>.</p>
      <p>Each of the <a href=
      "https://www.rfc-editor.org/rfc/rfc9420.html#name-mls-wire-formats">
      five MLS wire format</a> structures has an equivalent data
      type defined as an AS2 extension in the MLS context:
      <a>PublicMessage</a>, <a>PrivateMessage</a>, <a>Welcome</a>,
      <a>GroupInfo</a>, and <a>KeyPackage</a>.</p>
      <aside class="example" title=
      "An MLS private message delivered over ActivityPub">
        <pre class="json">
            {
              "@context": [
                "https://www.w3.org/ns/activitystreams",
                "https://purl.archive.org/socialweb/mls"
              ],
              "type": "Create",
              "id": "https://social.example/user/example1/create/2",
              "actor": "https://social.example/user/example1",
              "to": ["https://other.example/user/example2","https://third.example/user/example3"],
              "object": {
                "type": ["Object", "PrivateMessage"],
                "id": "https://social.example/user/example1/privatemessage/1",
                "attributedTo": "https://social.example/user/example1",
              "to": ["https://other.example/user/example2","https://third.example/user/example3"],
                "summary": "This is an encrypted private message. See https://swicg.github.io/activitypub-e2ee/ for information about how to read messages like these."
                "mediaType": "message/mls",
                "encoding": "base64"
                "content": "[base64-encoded private message object]"
              }
            }
          </pre>
      </aside>
      <p>Delivery of MLS objects over the ActivityPub network
      requires addressing all recipients explicitly. See <a href=
      "#privacy-considerations">Privacy considerations</a> for more
      details.</p>
      <p>Reading incoming messages is done through the actor's
      <a href="https://www.w3.org/TR/activitypub/#inbox">inbox</a>
      property. This is a collection of all activities received by
      the actor,including but not exclusive to activities related
      to MLS. ActivityPub does not support push notifications, so
      MLS-enabled ActivityPub clients have to periodically poll the
      inbox collection for new activities.</p>
      <p>Other activities in the object lifecycle, such as
      reactions, updates, or deletions, should be handled as part
      of the <a>application data</a> within MLS private messages,
      and not as regular ActivityPub activities. So, for example,
      creating and updating an encrypted <code>Note</code> is
      modeled as two <a href=
      "https://www.w3.org/TR/activitystreams-vocabulary/#dfn-create">
      Create</a> activities -- one for the creation, the second for
      the update.</p>
    </section>
    <section id="key-storage">
      <h3>Key storage</h3>
      <p>Each actor in the ActivityPub network has a public profile
      with important protocol properties defined, such as <a href=
      "https://www.w3.org/tr/activitypub/#inbox">inbox</a>,
      <a href="https://www.w3.org/TR/activitypub/#following">following</a>,
      and <a href=
      "https://www.w3.org/TR/activitypub/#actor-objects">preferredUsername</a>.</p>
      <p>The set of currently valid <a>KeyPackage</a> objects for
      an actor are an additional property of the actor object,
      <a>keyPackages</a>. Its value is an ActivityPub <a href=
      "https://www.w3.org/TR/activitystreams-vocabulary/#dfn-collection">
      Collection</a> of KeyPackage objects.</p>
      <aside class="example" title=
      "An actor with a keyPackages property">
        <pre class="json">
            {
              "@context": [
                "https://www.w3.org/ns/activitystreams",
                "https://purl.archive.org/socialweb/mls"
              ],
              "type": "Person",
              "id": "https://social.example/user/example1",
              "name": "Example User",
              "preferredUsername": "example1",
              "inbox": "https://social.example/user/example1/inbox",
              "outbox": "https://social.example/user/example1/outbox",
              "keyPackages": {
                "type": "Collection",
                "id":  "https://social.example/user/example1/keyPackages",
                "totalItems": 2,
                "items": [
                  "https://social.example/user/example1/keyPackage/A",
                  "https://social.example/user/example1/keyPackage/B"
                ]
              }
            }
          </pre>
      </aside>
      <p>A KeyPackage object for an actor goes through 4 steps in
      its lifecycle:</p>
      <ol>
        <li>
          <a href=
          "https://www.w3.org/TR/activitystreams-vocabulary/#dfn-create">
          Create</a> to create the object
        </li>
        <li>
          <a href=
          "https://www.w3.org/TR/activitystreams-vocabulary/#dfn-add">
          Add</a> to add it to the collection of valid key packages
        </li>
        <li>
          <a href=
          "https://www.w3.org/TR/activitystreams-vocabulary/#dfn-remove">
          Remove</a> to remove it from the collection
        </li>
        <li>
          <a href=
          "https://www.w3.org/TR/activitystreams-vocabulary/#dfn-delete">
          Delete</a> to delete it and make it unavailable
        </li>
      </ol>Create and Add must be strictly ordered; it's not
      possible to add a KeyPackage before creating it. Removal and
      Deletion are less strictly ordered; a key package can be
      removed, then deleted, or vice versa.
      <aside class="example" title="Creating a key package">
        <pre class="json">
          {
            "@context": [
              "https://www.w3.org/ns/activitystreams",
              "https://purl.archive.org/socialweb/mls"
            ],
            "type": "Create",
            "id": "https://social.example/user/example1/create/3",
            "actor": "https://social.example/user/example1",
            "to": "as:Public",
            "object": {
              "type": ["Object", "KeyPackage"],
              "id": "https://social.example/user/example1/keyPackage/C",
              "attributedTo": "https://social.example/user/example1",
              "to": "as:Public",
              "summary": "This is binary-encoded cryptographic key package. See https://swicg.github.io/activitypub-e2ee/ for information about how to read messages like these."
              "mediaType": "message/mls",
              "encoding": "base64"
              "content": "[base64-encoded private message object]",
              "generator": {
                "id": "https://client.example/actor",
                "type": "Application",
                "name": "Example MLS over ActivityPub client"
              }
            }
          }
          </pre>
      </aside>
      <p>The <code>generator</code> property can be used to
      identify the client application associated with the
      <code>KeyPackage</code>.</p>
      <aside class="example" title=
      "Adding a key package to the keyPackages collection">
        <pre class="json">
          {
            "@context": [
                "https://www.w3.org/ns/activitystreams",
                "https://purl.archive.org/socialweb/mls"
            ],
            "type": "Add",
            "id": "https://social.example/user/example1/add/1",
            "actor": "https://social.example/user/example1",
            "to": "as:Public",
            "object": "https://social.example/user/example1/keyPackage/C",
            "target": "https://social.example/user/example1/keyPackages"
          }
          </pre>
      </aside>
      <aside class="example" title=
      "Removing a key package from the keyPackages collection">
        <pre class="json">
          {
            "@context": [
                "https://www.w3.org/ns/activitystreams",
                "https://purl.archive.org/socialweb/mls"
            ],
            "type": "Remove",
            "id": "https://social.example/user/example1/remove/1",
            "actor": "https://social.example/user/example1",
            "to": "as:Public",
            "object": "https://social.example/user/example1/keyPackage/C",
            "target": "https://social.example/user/example1/keyPackages"
          }
          </pre>
      </aside>
      <aside class="example" title="Deleting a key package">
        <pre class="json">
          {
            "@context": [
                "https://www.w3.org/ns/activitystreams",
                "https://purl.archive.org/socialweb/mls"
            ],
            "type": "Delete",
            "id": "https://social.example/user/example1/delete/1",
            "actor": "https://social.example/user/example1",
            "to": "as:Public",
            "object": "https://social.example/user/example1/keyPackage/C"
          }
          </pre>
      </aside>
      <p>As with all ActivityPub objects, the KeyPackage can be
      read in full using an HTTP GET request to the <a href=
      "https://www.w3.org/TR/activitystreams-vocabulary/#dfn-id">id</a>
      URL.</p>
    </section>
  </section>
  <section id="authentication-service">
    <h2>Authentication Service</h2>
    <p>The Authentication Service in the MLS framework has the
    responsibility of confirming the relationship between a
    <code>KeyPackage</code> object and an identity. In ActivityPub,
    an identity is expressed as an actor object URL.</p>
    <p>In the ActivityPub model shown here, authenticating a
    <code>KeyPackage</code> requires three steps:</p>
    <ol>
      <li>Retrieving the actor with the given ID; this requires an
      HTTP GET request to the actor ID URL.</li>
      <li>Verifying that the actor object has a
      <code>keyPackages</code> property.</li>
      <li>Confirming that the given <code>KeyPackage</code> object
      is an item in the <code>keyPackages</code> collection.</li>
    </ol>
  </section>
  <section id="application-data">
    <h2><dfn class="export">Application data</dfn></h2>
    <p>MLS is agnostic about application data encrypted and sent
    over the network. To match the ActivityPub model, this
    specification defines the application data for use over MLS as
    Activity Streams 2.0 content objects and activities. Unlike
    ActivityPub objects, these AS2 objects are not available for
    download from any server, and do not use HTTPS URLs as
    <code>id</code> values.</p>
    <p>In general, the content of the MLS messages should be
    self-encapsulated and not dependent on external resources.
    Client applications cannot rely on a server to save state for
    the group and the shared application data. This restricts the
    use of URLs and <code>Link</code> objects in the content.</p>
    <section id="content-objects">
      <h3>Content objects</h3>
      <p>The Activity Vocabulary defines several document types for
      content. The following types are used in this
      specification.</p>
      <ul>
        <li>
          <a href=
          "https://www.w3.org/TR/activitystreams-vocabulary/#dfn-note">
          Note</a> - for short text, about a paragraph or less,
          like a microblogging post or a comment
        </li>
        <li>
          <a href=
          "https://www.w3.org/TR/activitystreams-vocabulary/#dfn-article">
          Article</a> - for longer texts, about the length of a
          magazine article or a blog post
        </li>
        <li>
          <a href=
          "https://www.w3.org/TR/activitystreams-vocabulary/#dfn-image">
          Image</a> - two-dimensional images, like photos or
          diagrams
        </li>
        <li>
          <a href=
          "https://www.w3.org/TR/activitystreams-vocabulary/#dfn-audio">
          Audio</a> - any sound files, like music, a sound effect,
          or a podcast episode
        </li>
        <li>
          <a href=
          "https://www.w3.org/TR/activitystreams-vocabulary/#dfn-video">
          Video</a> - moving images, like a movie, TV show, or
          short
        </li>
      </ul>There are the following restrictions on the properties
      of the content objects:
      <ul>
        <li><code>id</code>. This should be a unique URI, but not
        an HTTPS URL. A UUID, for example, provides a reasonably
        unique value that can be indexed in the client's local
        storage.</li>
        <li><code>mediaType</code>. For <code>Note</code> and
        <code>Article</code>, these should be unset, or use the
        default "text/html". For the other content types, this
        should include the Internet Media Type for the object, such
        as "image/png" or "video/ogg".</li>
        <li><code>encoding</code>. A new property introduced in
        this document; the default value is "base64", for base64
        encoding.</li>
        <li><code>content</code>. For <code>Note</code> and
        <code>Article</code>, this should be the HTML content of
        the object, as usual. For the other types, this should be
        the base64-encoded content of the object itself. For an
        <code>Image</code> in Portable Network Graphics (PNG)
        format, the <code>content</code> property value will be the
        base64-encoded image data.</li>
        <li><code>summary</code>. A summary or description of the
        content.</li>
        <li><code>url</code>. This should be undefined; the object
        should not have a version available as a Web page.</li>
        <li><code>attachment</code>. These values should not be
        <code>Link</code> objects; instead, they should be content
        objects of the above types. They should be included fully
        using base64-encoded values in the <code>content</code>
        property, with the <code>mediaType</code> property
        set.</li>
        <li><code>inReplyTo</code>. Should be the <code>id</code>
        of a content object already delivered to the same
        group.</li>
        <li><code>replies</code>, <code>likes</code>, and
        <code>shares</code>. In this application of MLS, reactions
        to content objects are not tracked by a server, but by each
        client individually. Consequently, these values should be
        unset.</li>
      </ul>
    </section>
    <section id="activities">
      <h3>Activities</h3>
      <p>Activities are the top-level content in MLS messages.</p>
      <p>The following Activity types from the Activity Vocabulary
      are defined in this document.</p>
      <ul>
        <li>
          <code>Create</code> Introduces a new object. The value of
          the <code>object</code> property should be a <a href=
          "https://www.w3.org/TR/json-ld11/#node-objects">node
          object</a> -- all properties represented as a JSON
          object. The <code>id</code> of the object must be unique.
        </li>
        <li><code>Update</code> Updates the properties of an
        existing object.Only changed properties must be included in
        the <code>object</code> property. The <code>id</code>
        property must match an object that was received as the
        <code>object</code> of a <code>Create</code> property
        previously. Only the sender of the <code>Create</code>
        activity can send an <code>Update</code> for the same
        object.</li>
        <li><code>Delete</code> Deletes an existing object. The
        <code>object</code> property can be a node object or a
        reference. The <code>id</code> property must match an
        object that was received as the <code>object</code> of a
        <code>Create</code> property previously. Only the sender of
        the <code>Create</code> activity can send an
        <code>Delete</code> for the same object.</li>
        <li><code>Like</code> Indicates that the sender likes the
        <code>object</code>. The <code>object</code> property can
        be a node object or a reference. The <code>id</code>
        property must match an object that was received as the
        <code>object</code> of a <code>Create</code> property
        previously.</li>
        <li><code>Announce</code> Shares the <code>object</code>
        with the group. The <code>object</code> property should be
        a node object. The <code>id</code> property can match an
        object that was received as the <code>object</code> of a
        <code>Create</code> property previously; alternately, it
        can be an ActivityPub object with an HTTPS URL
        <code>id</code>.</li>
        <li><code>Undo</code> Undoes the activity that is the
        <code>object</code>. The <code>object</code> property can
        be a node object or a reference. The <code>id</code>
        property must match an activity that was received
        previously. Only the sender of the previous activity can
        undo it. Undoing a <code>Like</code> activity shows that
        the sender does not like the object. The results of undoing
        other activity types are undefined.</li>
        <li><code>Read</code>. Indicates that the sender has read a
        <code>Note</code> or <code>Article</code>, or the
        description of an <code>Image</code> or other binary file
        type. The <code>object</code> property should be a partial
        embedding or a reference. The <code>id</code> property must
        match an object that was received as the
        <code>object</code> of a <code>Create</code> property
        previously.</li>
        <li><code>Listen</code>. Indicates that the sender has
        listened to an <code>Audio</code> object. The
        <code>object</code> property should be a partial embedding
        or a reference. The <code>id</code> property must match an
        object that was received as the <code>object</code> of a
        <code>Create</code> property previously.</li>
        <li><code>View</code>. Indicates that the sender has viewed
        an <code>Image</code> object or <code>Video</code> object.
        The <code>object</code> property should be a partial
        embedding or a reference. The <code>id</code> property must
        match an object that was received as the
        <code>object</code> of a <code>Create</code> property
        previously.</li>
      </ul>
    </section>
    <section id="extensions">
      <h3>Extensions</h3>
      <p>Other activity or content types from the Activity
      Vocabulary, and from Activity Streams 2.0 extensions, may be
      used in this structure. The use of extended properties or
      types in the encrypted content of MLS over ActivityPub should
      be documented on the W3C wiki.</p>
    </section>
  </section>
  <section id="context">
    <h2>Context</h2>
    <p>The terms in this document are defined in a context document
    that can be used in [[JSON-LD]] documents. The context document
    is available at <a href=
    "https://purl.archive.org/socialweb/mls">https://purl.archive.org/socialweb/mls</a>.</p>
    <p>To use these terms, documents should include this context
    URL in the <code>@context</code> property of the JSON-LD
    document.</p>
    <aside class="example">
      <p>Example usage of the context.</p>
      <pre class="json">
            {
              "@context": [
                "https://www.w3.org/ns/activitystreams",
                "https://purl.archive.org/socialweb/mls"
              ],
              "id": "https://example.com/users/evan",
              "type": "Person",
              "name": "Evan Prodromou",
              "keyPackages": [
                "https://example.com/keys/evan/client1",
                "https://example.com/keys/evan/client2"
              ]
            }
          </pre>
    </aside>
    <p>The context document defines a namespace prefix
    <code>mls</code> defined as
    <code>https://purl.archive.org/socialweb/mls#</code>.</p>
    <section>
      <h3>Version-stamped URLs</h3>
      <p>To ease the use of this context for implementers with
      strict versioning requirements, additional URL aliases are
      provided with versions included. A <a href=
      "https://semver.org/">semantic versioning</a> strategy is
      used to convey the guarantees of the version number.</p>
      <table>
        <tbody>
          <tr>
            <th>Version</th>
            <th>URL</th>
            <th>Notes</th>
          </tr>
          <tr>
            <td>(latest)</td>
            <td>
              <a href=
              "https://purl.archive.org/socialweb/mls">https://purl.archive.org/socialweb/mls</a>
            </td>
            <td>The latest version of the context is always
            available at this URL. Most implementers can use this
            URL.</td>
          </tr>
          <tr>
            <td>1.0.0</td>
            <td>
              <a href=
              "https://purl.archive.org/socialweb/mls/1.0.0">https://purl.archive.org/socialweb/mls/1.0.0</a>
            </td>
            <td>The exact version of the context document. The
            resource at this URL should be immutable. This URL is
            useful for implementers that need an exact, byte-wise
            replicable version of the document.</td>
          </tr>
          <tr>
            <td>1.0.x</td>
            <td>
              <a href=
              "https://purl.archive.org/socialweb/mls/1.0">https://purl.archive.org/socialweb/mls/1.0</a>
            </td>
            <td>Backwards-compatible fixes are possible, but no
            additional types or properties are defined. This is
            useful for implementers that use multiple extensions
            and want to ensure that no conflicting terms are
            added.</td>
          </tr>
          <tr>
            <td>1.x.x</td>
            <td>
              <a href=
              "https://purl.archive.org/socialweb/mls/1">https://purl.archive.org/socialweb/mls/1</a>
            </td>
            <td>Backwards-compatible fixes, additional types and
            properties are possible. This is useful for
            implementers that want to ensure that the properties
            and types they use are stable and will not change, but
            do not need to avoid term conflicts.</td>
          </tr>
        </tbody>
      </table>
      <p>Using the version-stamped context URLs is similar to the
      unstamped URL.</p>
      <aside class="example">
        <p>Example usage of a version-stamped context URL.</p>
        <pre class="json">
                    {
                      "@context": [
                        "https://www.w3.org/ns/activitystreams",
                        "https://purl.archive.org/socialweb/mls/1.0"
                      ],
                      "id": "https://example.com/users/evan",
                      "type": "Person",
                      "name": "Evan Prodromou",
                      "keyPackages": [
                        "https://example.com/keys/evan/client1",
                        "https://example.com/keys/evan/client2"
                      ]
                    }
                  </pre>
      </aside>
      <p>If backwards-incompatible changes to this context are made
      in the future, a new major version (2.x.x) would be added and
      the existing 1.x.x URLs would continue to be provided.</p>
    </section>
  </section>
  <section id="terms">
    <h2>Terms</h2>
    <p>These terms are defined in the MLS namespace for
    ActivityPub. There are five new object types, and one new
    property.</p>
    <section id="types">
      <h3>Types</h3>
      <p>There are five types defined in this context.</p>
      <section id="PublicMessage">
        <h3><dfn class="export">PublicMessage</dfn></h3>
        <table>
          <tbody>
            <tr>
              <td>URI:</td>
              <td>
              <code>https://purl.archive.org/socialweb/mls#PublicMessage</code><br>

              <code>mls:PublicMessage</code><br>
              <code>PublicMessage</code></td>
            </tr>
            <tr>
              <td>Notes:</td>
              <td>
                <p>The PublicMessage data type from MLS. The
                <code>mediaType</code> should be "message/mls", and
                the <code>content</code> should be base64-encoded
                binary data matching an <a href=
                "https://www.rfc-editor.org/rfc/rfc9420.html#name-message-framing">
                MLSMessage</a> structure with a <a href=
                "https://www.rfc-editor.org/rfc/rfc9420.html#name-encoding-and-decoding-a-pub">
                PublicMessage</a> wire type.</p>
              </td>
            </tr>
            <tr>
              <td>Extends:</td>
              <td><code>Object</code></td>
            </tr>
            <tr>
              <td>Properties:</td>
              <td>Inherited from <code>Object</code></td>
            </tr>
          </tbody>
        </table>
        <aside class="example">
          <p>A PublicMessage object.</p>
          <pre class="json">
            {
              "@context": [
                "https://www.w3.org/ns/activitystreams",
                "https://purl.archive.org/socialweb/mls"
              ],
              "id": "https://example.com/users/alyssa/publicmessage/1",
              "type": "PublicMessage",
              "attributedTo": "https://example.com/users/alyssa",
              "to": [
                "https://social.example/users/example1",
                "https://another.example/users/example2"
              ],
              "mediaType": "message/mls",
              "encoding": "base64",
              "summary": "This is a public message in MLS format.",
              "content": "[base64-encoded MLSMessage]",
              "generator": {
                "id": "https://client.example/actor",
                "type": "Application",
                "name": "MLS-enabled ActivityPub client"
              }
            }
            </pre>
        </aside>
      </section>
      <section id="PrivateMessage">
        <h3><dfn class="export">PrivateMessage</dfn></h3>
        <table>
          <tbody>
            <tr>
              <td>URI:</td>
              <td>
              <code>https://purl.archive.org/socialweb/mls#PrivateMessage</code><br>

              <code>mls:PrivateMessage</code><br>
              <code>PrivateMessage</code></td>
            </tr>
            <tr>
              <td>Notes:</td>
              <td>
                <p>The PrivateMessage data type from MLS. The
                <code>mediaType</code> should be "message/mls", and
                the <code>content</code> should be base64-encoded
                binary data matching an <a href=
                "https://www.rfc-editor.org/rfc/rfc9420.html#name-message-framing">
                MLSMessage</a> structure with a <a href=
                "https://www.rfc-editor.org/rfc/rfc9420.html#name-encoding-and-decoding-a-pri">
                PrivateMessage</a> wire type.</p>
              </td>
            </tr>
            <tr>
              <td>Extends:</td>
              <td><code>Object</code></td>
            </tr>
            <tr>
              <td>Properties:</td>
              <td>Inherited from <code>Object</code></td>
            </tr>
          </tbody>
        </table>
        <aside class="example">
          <p>A PrivateMessage object.</p>
          <pre class="json">
            {
              "@context": [
                "https://www.w3.org/ns/activitystreams",
                "https://purl.archive.org/socialweb/mls"
              ],
              "id": "https://example.com/users/alyssa/privatemessage/1",
              "type": "PrivateMessage",
              "attributedTo": "https://example.com/users/alyssa",
              "to": [
                "https://social.example/users/example1",
                "https://another.example/users/example2"
              ],
              "mediaType": "message/mls",
              "encoding": "base64",
              "summary": "This is a private message in MLS format.",
              "content": "[base64-encoded MLSMessage]",
              "generator": {
                "id": "https://client.example/actor",
                "type": "Application",
                "name": "MLS-enabled ActivityPub client"
              }
            }
            </pre>
        </aside>
      </section>
      <section id="KeyPackage">
        <h3><dfn class="export">KeyPackage</dfn></h3>
        <table>
          <tbody>
            <tr>
              <td>URI:</td>
              <td>
              <code>https://purl.archive.org/socialweb/mls#KeyPackage</code><br>

              <code>mls:KeyPackage</code><br>
              <code>KeyPackage</code></td>
            </tr>
            <tr>
              <td>Notes:</td>
              <td>
                <p>The KeyPackage data type from MLS. The
                <code>mediaType</code> should be "message/mls", and
                the <code>content</code> should be base64-encoded
                binary data matching an <a href=
                "https://www.rfc-editor.org/rfc/rfc9420.html#name-message-framing">
                MLSMessage</a> structure with a <a href=
                "https://www.rfc-editor.org/rfc/rfc9420.html#name-key-packages">
                KeyPackage</a> wire type.</p>
              </td>
            </tr>
            <tr>
              <td>Extends:</td>
              <td><code>Object</code></td>
            </tr>
            <tr>
              <td>Properties:</td>
              <td>Inherited from <code>Object</code></td>
            </tr>
          </tbody>
        </table>
        <aside class="example">
          <p>A KeyPackage object.</p>
          <pre class="json">
          {
            "@context": [
              "https://www.w3.org/ns/activitystreams",
              "https://purl.archive.org/socialweb/mls"
            ],
            "id": "https://example.com/users/alyssa/keypackage/1",
            "type": "PrivateMessage",
            "attributedTo": "https://example.com/users/alyssa",
            "to": "as:Public",
            "mediaType": "message/mls",
            "encoding": "base64",
            "summary": "This is a key package in MLS format.",
            "content": "[base64-encoded MLSMessage]",
            "generator": {
              "id": "https://client.example/actor",
              "type": "Application",
              "name": "MLS-enabled ActivityPub client"
            }
          }
          </pre>
        </aside>
      </section>
      <section id="GroupInfo">
        <h3><dfn class="export">GroupInfo</dfn></h3>
        <table>
          <tbody>
            <tr>
              <td>URI:</td>
              <td>
              <code>https://purl.archive.org/socialweb/mls#GroupInfo</code><br>

              <code>mls:GroupInfo</code><br>
              <code>GroupInfo</code></td>
            </tr>
            <tr>
              <td>Notes:</td>
              <td>
                <p>The GroupInfo data type from MLS. The
                <code>mediaType</code> should be "message/mls", and
                the <code>content</code> should be base64-encoded
                binary data matching an <a href=
                "https://www.rfc-editor.org/rfc/rfc9420.html#name-message-framing">
                MLSMessage</a> structure with a <a href=
                "https://www.rfc-editor.org/rfc/rfc9420.html#section-12.4.3">
                GroupInfo</a> wire type.</p>
              </td>
            </tr>
            <tr>
              <td>Extends:</td>
              <td><code>Object</code></td>
            </tr>
            <tr>
              <td>Properties:</td>
              <td>Inherited from <code>Object</code></td>
            </tr>
          </tbody>
        </table>
        <aside class="example">
          <p>A GroupInfo object.</p>
          <pre class="json">
          {
            "@context": [
              "https://www.w3.org/ns/activitystreams",
              "https://purl.archive.org/socialweb/mls"
            ],
            "id": "https://example.com/users/alyssa/groupinfo/1",
            "type": "GroupInfo",
            "attributedTo": "https://example.com/users/alyssa",
            "to": "https://social.example/user/example1",
            "mediaType": "message/mls",
            "encoding": "base64",
            "summary": "This is a group information packet in MLS format.",
            "content": "[base64-encoded MLSMessage]",
            "generator": {
              "id": "https://client.example/actor",
              "type": "Application",
              "name": "MLS-enabled ActivityPub client"
            }
          }
          </pre>
        </aside>
      </section>
      <section id="Welcome">
        <h3><dfn class="export">Welcome</dfn></h3>
        <table>
          <tbody>
            <tr>
              <td>URI:</td>
              <td>
              <code>https://purl.archive.org/socialweb/mls#Welcome</code><br>

              <code>mls:Welcome</code><br>
              <code>Welcome</code></td>
            </tr>
            <tr>
              <td>Notes:</td>
              <td>
                <p>The Welcome data type from MLS. The
                <code>mediaType</code> should be "message/mls", and
                the <code>content</code> should be base64-encoded
                binary data matching an <a href=
                "https://www.rfc-editor.org/rfc/rfc9420.html#name-message-framing">
                MLSMessage</a> structure with a <a href=
                "https://www.rfc-editor.org/rfc/rfc9420.html#section-12.4.3.1">
                Welcome</a> wire type.</p>
              </td>
            </tr>
            <tr>
              <td>Extends:</td>
              <td><code>Object</code></td>
            </tr>
            <tr>
              <td>Properties:</td>
              <td>Inherited from <code>Object</code></td>
            </tr>
          </tbody>
        </table>
        <aside class="example">
          <p>A GroupInfo object.</p>
          <pre class="json">
          {
            "@context": [
              "https://www.w3.org/ns/activitystreams",
              "https://purl.archive.org/socialweb/mls"
            ],
            "id": "https://example.com/users/alyssa/welcome/1",
            "type": "GroupInfo",
            "attributedTo": "https://example.com/users/alyssa",
            "to": "https://social.example/user/example1",
            "mediaType": "message/mls",
            "encoding": "base64",
            "summary": "This is a welcome packet in MLS format.",
            "content": "[base64-encoded MLSMessage]",
            "generator": {
              "id": "https://client.example/actor",
              "type": "Application",
              "name": "MLS-enabled ActivityPub client"
            }
          }
          </pre>
        </aside>
      </section>
    </section>
    <section id="properties">
      <h3>Properties</h3>
      <p>There are two properties defined in the namespace.</p>
      <section id="encoding">
        <h3><dfn class="export">encoding</dfn></h3>
        <table>
          <tbody>
            <tr>
              <td>URI:</td>
              <td>
              <code>https://purl.archive.org/socialweb/mls#encoding</code><br>
              <code>mls:encoding</code><br>
              <code>encoding</code></td>
            </tr>
            <tr>
              <td>Notes:</td>
              <td>
                <p>The <code>encoding</code> property represents
                the encoding for the <code>content</code> property,
                similar to the <a href=
                "https://www.ietf.org/rfc/rfc2045.html#section-6">Content-Transfer-Encoding</a>
                header in email and HTTP messages.</p>
              </td>
            </tr>
            <tr>
              <td>Domain:</td>
              <td><code>Object</code></td>
            </tr>
            <tr>
              <td>Range:</td>
              <td>
                String; values for <a href=
                "https://www.ietf.org/rfc/rfc2045.html#section-6">Content-Transfer-Encoding</a>
                in [[rfc2045]]
              </td>
            </tr>
            <tr>
              <td>Functional:</td>
              <td><code>true</code></td>
            </tr>
          </tbody>
        </table>
        <aside class="example">
          <p>An Image object with an encoding property.</p>
          <pre class="json">
            {
              "@context": [
                "https://www.w3.org/ns/activitystreams",
                "https://purl.archive.org/socialweb/mls"
              ],
              "id": "https://example.com/image/1",
              "type": "Image",
              "name": "One-pixel PNG",
              "mediaType": "image/png",
              "encoding": "base64",
              "content": "iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAAA1BMVEUAAACnej3aAAAAAXRSTlMAQObYZgAAAApJREFUCNdjYAAAAAIAAeIhvDMAAAAASUVORK5CYII="
            }
            </pre>
        </aside>
      </section>
      <section id="keyPackages">
        <h3><dfn class="export">keyPackages</dfn></h3>
        <table>
          <tbody>
            <tr>
              <td>URI:</td>
              <td>
              <code>https://purl.archive.org/socialweb/mls#keyPackages</code><br>

              <code>mls:keyPackages</code><br>
              <code>keyPackages</code></td>
            </tr>
            <tr>
              <td>Notes:</td>
              <td>
                <p>The <code>keyPackages</code> property represents
                the client keys for an actor. As with other JSON-LD
                <code>@id</code> properties, its value can be a
                string for the URL of the key, a JSON object with
                the properties of the key itself, or an array of
                strings and/or objects.</p>
              </td>
            </tr>
            <tr>
              <td>Domain:</td>
              <td>
                <code>Object</code> (an ActivityPub <a href=
                "https://www.w3.org/TR/activitypub/#actors">Actor</a>)
              </td>
            </tr>
            <tr>
              <td>Range:</td>
              <td><code>Key</code></td>
            </tr>
            <tr>
              <td>Functional:</td>
              <td><code>false</code></td>
            </tr>
          </tbody>
        </table>
        <aside class="example">
          <p>An ActivityPub actor with an <code>keyPackages</code>
          property.</p>
          <pre class="json">
            {
              "@context": [
                "https://www.w3.org/ns/activitystreams",
                "https://purl.archive.org/socialweb/mls"
              ],
              "id": "https://example.com/users/alyssa",
              "type": "Person",
              "name": "Alyssa P. Hacker",
              "inbox": "https://example.com/users/alyssa/inbox",
              "outbox": "https://example.com/users/alyssa/outbox",
              "followers": "https://example.com/users/alyssa/followers",
              "following": "https://example.com/users/alyssa/following",
              "liked": "https://example.com/users/alyssa/liked",
              "keyPackages": "https://example.com/users/alyssa/key"
            }
          </pre>
        </aside>
      </section>
    </section>
  </section>
  <section id="security-considerations">
    <h2>Security considerations</h2>
    <p>These are notable security considerations with this
    specification.</p>
    <section id="html-sanitization">
      <h3>HTML Sanitization</h3>
      <p>Many of the <a href="#content-objects">content types</a>
      included in the application data for this specification use
      HTML either for the <code>summary</code> or
      <code>content</code> properties. Attackers can use features
      of HTML5, like JavaScript and CSS, to cause problems in the
      users' browsers. One mitigation is to sanitize the HTML,
      removing elements and attributes that can be problematic for
      users.</p>
      <p>In ActivityPub, many servers will sanitize HTML for
      content as it arrives at the server, so that clients can use
      the content without security concerns. Because the encrypted
      application data in this specification is not visible to the
      ActivityPub server, it is up to the client application to
      sanitize the HTML.</p>
    </section>
    <section id="privacy-considerations">
      <h2>Privacy considerations</h2>
    </section>
  </section>
  <section id="conformance"></section>
</body>
</html>
